

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0,user-scalable=no" />
  <title>1. XuperChain环境部署 &mdash; xuperchain-doc  文档</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
        <script src="_static/stat.js"></script>
        <script src="_static/caption.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="XuperModel" href="design_documents/XuperModel.html" />
    <link rel="prev" title="总结" href="introduction/summary.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          <!-- 
            <a href="index.html" class="icon icon-home"> xuperchain-doc
           -->

          <!--  -->
          </a>

          
            
            
                <div class="version">
                    xuperchain-doc 3.10       
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
  
        
        
          
        
        
          <p class="caption" role="heading"><span class="caption-text">XUPERCHAIN介绍:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction/brief.html">简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/modules.html">模块</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/datastruct.html">核心数据结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/smart_contracts.html">智能合约</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/permission_system.html">权限系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/privacy.html">隐私和保密</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/perfomance.html">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/trusted_ledger_intro.html">可信账本</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/summary.html">总结</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">快速入门</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. XuperChain环境部署</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#env-prepare">1.1. 准备环境</a></li>
<li class="toctree-l2"><a class="reference internal" href="#env-compiling">1.2. 编译XuperChain</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#basic-operation">2. XuperChain基本操作</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#xchain">2.1. 部署xchain服务</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-chain">2.1.1. 创建链</a></li>
<li class="toctree-l3"><a class="reference internal" href="#svr-start">2.1.2. 启动服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="#svr-status">2.1.3. 确认服务状态</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage">2.2. 基本功能的使用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-account">2.2.1. 创建新账号</a></li>
<li class="toctree-l3"><a class="reference internal" href="#balance">2.2.2. 查询资源余额</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transfer">2.2.3. 转账</a></li>
<li class="toctree-l3"><a class="reference internal" href="#querytx">2.2.4. 查询交易信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="#block">2.2.5. 查询block信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multisig">2.2.6. 发起多重签名交易</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">技术设计文档:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="design_documents/XuperModel.html">XuperModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/XuperBridge.html">XuperBridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/xvm.html">XVM虚拟机</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/permission_model.html">账号权限控制模型</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/p2p.html">XuperChain p2p网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/authentication.html">身份认证</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/proposal.html">提案和投票机制</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/crypto.html">密码学和隐私保护</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/extension.html">插件机制</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/consensus.html">XuperChain 共识框架</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/chained_bft.html">Chained-BFT共识公共组件</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/xpos.html">XPoS共识</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/xpoa.html">XPoA共识</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/single_pow.html">Single及PoW共识</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/regulatory.html">XuperChain 监管机制</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/multidisk.html">多盘散列</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/group.html">平行链与群组</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/cross_chain.html">XuperChain 跨链技术</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_documents/trusted_ledger_design.html">可信账本</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">进阶使用</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/contract_accounts.html">合约账号</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/multi-nodes.html">多节点部署</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/create_contracts.html">创建合约</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/initiate_proposals.html">发起提案</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/multi-disks.html">配置变更</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/parallel_chain.html">使用平行链与群组</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/subscribe.html">使用事件订阅功能</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/readonly_queries.html">只读跨链场景使用文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/cross_chain.html">非事务场景跨链使用文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/construct-XPoA.html">搭建XPoA共识的 XuperChain 网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/trusted_ledger_advanced_usage.html">可信账本使用文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/monitoring.html">监控使用文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage/release.html">下载发行版</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开发应用</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developing_apps/eleccert.html">电子存证合约</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing_apps/erc721.html">数字资产交易</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开发手册</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development_manuals/XuperCDT.html">智能合约SDK使用说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_manuals/XdevManual.html">智能合约开发详解</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_manuals/XuperRPC.html">XuperChain RPC 接口使用说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="development_manuals/XuperIDE.html">XuperIDE 使用文档</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">XUPERCHAIN 测试环境</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="test_network/description.html">XuperChain 测试环境说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_network/guides.html">XuperChain 测试环境使用指南</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">贡献指南</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contribution/pull_requests.html">代码提交指南</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="operations_guides.html">操作指导</a></li>
<li class="toctree-l1"><a class="reference internal" href="video.html">视频教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands_reference.html">指令介绍(API)</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQs.html">常见问题解答</a></li>
<li class="toctree-l1"><a class="reference internal" href="vocabulary.html">词汇表</a></li>
<li class="toctree-l1"><a class="reference internal" href="lessons.html">XuperChain 小课堂</a></li>
</ul>

          
        
        
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">xuperchain-doc</a>
        
      </nav>


      <div class="wy-nav-content">
        

        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
<li><a href="index.html" class="breadtitle">首页</a>
</li>
<li>
   <img class="arrow_r" src="/_static/images/arrow_right.svg"/>
</li>

<li class="lititle"><span class="section-number">1. </span>XuperChain环境部署</li>

    
<li class="wy-breadcrumbs-aside">
   <a href="https://github.com/xuperchain/docs/edit/master/source/quickstart.rst" class="fa fa-github">
      编辑此页</a>
</li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>本章节将指导您获取XuperChain的代码并部署一个基础的可用环境，还会展示一些基本操作</p>
<div class="section" id="xuperchain">
<span id="env-deploy"></span><h1><span class="section-number">1. </span>XuperChain环境部署<a class="headerlink" href="#xuperchain" title="永久链接至标题">¶</a></h1>
<div class="section" id="env-prepare">
<span id="id1"></span><h2><span class="section-number">1.1. </span>准备环境<a class="headerlink" href="#env-prepare" title="永久链接至标题">¶</a></h2>
<p>XuperChain主要由Golang开发，需要首先准备编译运行的环境</p>
<ul class="simple">
<li><dl class="simple">
<dt>安装go语言编译环境，版本为1.11或更高</dt><dd><ul>
<li><p>下载地址：<a class="reference external" href="https://golang.org/dl/">golang</a></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>安装git</dt><dd><ul>
<li><p>下载地址：<a class="reference external" href="https://git-scm.com/download">git</a></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="env-compiling">
<span id="id2"></span><h2><span class="section-number">1.2. </span>编译XuperChain<a class="headerlink" href="#env-compiling" title="永久链接至标题">¶</a></h2>
<ul>
<li><p>使用git下载源码到本地</p>
<blockquote>
<div><ul class="simple">
<li><p>git clone <a class="reference external" href="https://github.com/xuperchain/xuperchain.git">https://github.com/xuperchain/xuperchain.git</a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>执行命令</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nb">cd</span> src/github.com/xuperchain/xuperchain
<span class="linenos">2</span>make
</pre></div>
</div>
<ul class="simple">
<li><p>在output目录得到产出xchain和xchain-cli</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>可能需要配置go语言环境变量（$GOROOT, $PATH）</p>
<dl class="simple">
<dt>GOPATH问题报错（go1.11版本之后无需关注）</dt><dd><ul class="simple">
<li><p>在1.11版本之前需要配置。配置成以下形式：</p></li>
<li><p>export GOPATH=xxx/github.com/xuperchain/xuperchain</p></li>
</ul>
</dd>
</dl>
<p>GCC版本需要升级到4或5以上</p>
</div>
</div>
</div>
<div class="section" id="basic-operation">
<span id="id3"></span><h1><span class="section-number">2. </span>XuperChain基本操作<a class="headerlink" href="#basic-operation" title="永久链接至标题">¶</a></h1>
<p>在output下，主要目录有data, logs, conf, plugins等, 二进制文件有xchain，xchain-cli</p>
<p>各目录的功能如下表：</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>目录名</p></th>
<th class="head"><p>功能</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>output/</p></td>
<td><p>节点根目录</p></td>
</tr>
<tr class="row-odd"><td><p>├─ conf</p></td>
<td><p>xchain.yaml: xchain服务的配置信息（注意端口冲突）
plugins.conf: 插件的配置信息</p></td>
</tr>
<tr class="row-even"><td><p>├─ data</p></td>
<td><p>数据的存放目录，创世块信息，以及共识和合约的样例</p></td>
</tr>
<tr class="row-odd"><td><p>│  ···   ├─ blockchain</p></td>
<td><p>账本目录</p></td>
</tr>
<tr class="row-even"><td><p>│  ···   ├─ keys</p></td>
<td><p>此节点的地址，具有全局唯一性</p></td>
</tr>
<tr class="row-odd"><td><p>│  ···   ├─ netkeys</p></td>
<td><p>此节点的网络标识ID，具有全局唯一性</p></td>
</tr>
<tr class="row-even"><td><p>│  ···   └─ config</p></td>
<td><p>包括创始的共识，初始的资源数，矿工奖励机制等</p></td>
</tr>
<tr class="row-odd"><td><p>├─ logs</p></td>
<td><p>程序日志目录</p></td>
</tr>
<tr class="row-even"><td><p>├─ plugins</p></td>
<td><p>so扩展的存放目录</p></td>
</tr>
<tr class="row-odd"><td><p>├─ xchain</p></td>
<td><p>xchain服务的二进制文件</p></td>
</tr>
<tr class="row-even"><td><p>├─ xchain-cli</p></td>
<td><p>xchain客户端工具</p></td>
</tr>
<tr class="row-odd"><td><p>└─ wasm2c</p></td>
<td><p>wasm工具（智能合约会用到）</p></td>
</tr>
</tbody>
</table>
<div class="section" id="xchain">
<span id="svr-deploy"></span><h2><span class="section-number">2.1. </span>部署xchain服务<a class="headerlink" href="#xchain" title="永久链接至标题">¶</a></h2>
<div class="section" id="create-chain">
<span id="id4"></span><h3><span class="section-number">2.1.1. </span>创建链<a class="headerlink" href="#create-chain" title="永久链接至标题">¶</a></h3>
<p>在启动xchain服务之前，我们首先需要创建一条链（创世区块），xchain客户端工具提供了此功能</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># 创建xuper链</span>
<span class="linenos">2</span>./xchain-cli createChain
</pre></div>
</div>
<div class="figure align-center" id="id13">
<img alt="创建链" src="https://xchain-xuperunion.bj.bcebos.com/learning/createChain.gif" />
<p class="caption"><span class="caption-text">创建链</span><a class="headerlink" href="#id13" title="永久链接至图片">¶</a></p>
</div>
<p>这样我们就使用 config/xuper.json 中的配置创建了一条链（此时 data/blockchain 中会生成 xuper 目录，里面即是我们创建的链的账本等文件）</p>
</div>
<div class="section" id="svr-start">
<span id="id5"></span><h3><span class="section-number">2.1.2. </span>启动服务<a class="headerlink" href="#svr-start" title="永久链接至标题">¶</a></h3>
<p>启动服务命令十分简单，还可以配合多种参数使用，详见命令行的 -h 输出</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># 启动服务节点</span>
<span class="linenos">2</span>nohup ./xchain <span class="p">&amp;</span>
</pre></div>
</div>
</div>
<div class="section" id="svr-status">
<span id="id6"></span><h3><span class="section-number">2.1.3. </span>确认服务状态<a class="headerlink" href="#svr-status" title="永久链接至标题">¶</a></h3>
<p>按照默认配置，xchain服务会监听37101端口，可以使用如下命令查看xchain服务的运行状态</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># check服务运行状况</span>
<span class="linenos">2</span>./xchain-cli status -H <span class="m">127</span>.0.0.1:37101
</pre></div>
</div>
<div class="figure align-center" id="id14">
<img alt="查看状态" src="https://xchain-xuperunion.bj.bcebos.com/learning/status.gif" />
<p class="caption"><span class="caption-text">查看运行状态</span><a class="headerlink" href="#id14" title="永久链接至图片">¶</a></p>
</div>
</div>
</div>
<div class="section" id="basic-usage">
<span id="id7"></span><h2><span class="section-number">2.2. </span>基本功能的使用<a class="headerlink" href="#basic-usage" title="永久链接至标题">¶</a></h2>
<div class="section" id="create-account">
<span id="id8"></span><h3><span class="section-number">2.2.1. </span>创建新账号<a class="headerlink" href="#create-account" title="永久链接至标题">¶</a></h3>
<p>xchain中，账号分为普通账号和“合约账号”，这里先介绍普通账号的创建，命令如下</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># 创建普通用户, 包含地址，公钥，私钥</span>
<span class="linenos">2</span>./xchain-cli account newkeys --output data/bob
<span class="linenos">3</span><span class="c1"># 在bob目录下会看到文件address，publickey，privatekey生成</span>
</pre></div>
</div>
<div class="figure align-center" id="id15">
<img alt="创建账号" src="https://xchain-xuperunion.bj.bcebos.com/learning/newkey.gif" />
<p class="caption"><span class="caption-text">创建账号</span><a class="headerlink" href="#id15" title="永久链接至图片">¶</a></p>
</div>
</div>
<div class="section" id="balance">
<span id="id9"></span><h3><span class="section-number">2.2.2. </span>查询资源余额<a class="headerlink" href="#balance" title="永久链接至标题">¶</a></h3>
<p>对于普通账号，可使用如下命令查询账号资源余额，其中 -H 参数为xchain服务的地址</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>./xchain-cli account balance --keys data/keys -H <span class="m">127</span>.0.0.1:37101
</pre></div>
</div>
<div class="figure align-center" id="id16">
<img alt="查询余额" src="https://xchain-xuperunion.bj.bcebos.com/learning/balance.gif" />
<p class="caption"><span class="caption-text">查询余额</span><a class="headerlink" href="#id16" title="永久链接至图片">¶</a></p>
</div>
</div>
<div class="section" id="transfer">
<span id="id10"></span><h3><span class="section-number">2.2.3. </span>转账<a class="headerlink" href="#transfer" title="永久链接至标题">¶</a></h3>
<p>转账操作需要提供源账号的私钥目录，也就类似“1.2.4.1”中生成的目录，这里注意到并不需要提供目标账号的任何密钥，只需要提供地址即可</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># --keys 从此地址 转给 --to地址 --amount 钱</span>
<span class="linenos">2</span>./xchain-cli transfer --to czojZcZ6cHSiDVJ4jFoZMB1PjKnfUiuFQ --amount <span class="m">10</span> --keys data/keys/ -H <span class="m">127</span>.0.0.1:37101
</pre></div>
</div>
<p>命令执行的返回是转账操作的交易id（txid）</p>
<div class="figure align-center" id="id17">
<img alt="普通转账" src="https://xchain-xuperunion.bj.bcebos.com/learning/transfer.gif" />
<p class="caption"><span class="caption-text">普通转账操作</span><a class="headerlink" href="#id17" title="永久链接至图片">¶</a></p>
</div>
</div>
<div class="section" id="querytx">
<span id="id11"></span><h3><span class="section-number">2.2.4. </span>查询交易信息<a class="headerlink" href="#querytx" title="永久链接至标题">¶</a></h3>
<p>通过以下命令可以查询交易的信息，包括交易状态、交易的源和目标账号、交易的金额、所在的区块（如果已上链）等内容</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># 可查询上一步生成的txid的交易信息</span>
<span class="linenos">2</span>./xchain-cli tx query cbbda2606837c950160e99480049e2aec3e60689a280b68a2d253fdd8a6ce931 -H <span class="m">127</span>.0.0.1:37101
</pre></div>
</div>
<div class="figure align-center" id="id18">
<img alt="查询交易" src="https://xchain-xuperunion.bj.bcebos.com/learning/querytx.gif" />
<p class="caption"><span class="caption-text">查询交易</span><a class="headerlink" href="#id18" title="永久链接至图片">¶</a></p>
</div>
</div>
<div class="section" id="block">
<span id="queryblock"></span><h3><span class="section-number">2.2.5. </span>查询block信息<a class="headerlink" href="#block" title="永久链接至标题">¶</a></h3>
<p>通过blockid可以查询区块的相关信息，包括区块内打包的交易、所在链的高度、前驱/后继区块的id等内容</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># 可查询上一步交易所在的block id信息</span>
<span class="linenos">2</span>./xchain-cli block 0354240c8335e10d8b48d76c0584e29ab604cfdb7b421d973f01a2a49bb67fee -H <span class="m">127</span>.0.0.1:37101
</pre></div>
</div>
<div class="figure align-center" id="id19">
<img alt="查询区块" src="https://xchain-xuperunion.bj.bcebos.com/learning/queryblock.gif" />
<p class="caption"><span class="caption-text">查询区块</span><a class="headerlink" href="#id19" title="永久链接至图片">¶</a></p>
</div>
</div>
<div class="section" id="multisig">
<span id="id12"></span><h3><span class="section-number">2.2.6. </span>发起多重签名交易<a class="headerlink" href="#multisig" title="永久链接至标题">¶</a></h3>
<p>对于需要多个账号签名才可以生效的交易，需要先发起多重签名交易，收集需要的签名，然后再发出</p>
<p>对需要收集签名的账号地址，需要事先维护在一个文件中（假定名为addr_list），每个地址一行</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="go">YDYBchKWXpG7HSkHy4YoyzTJnd3hTFBgG</span>
<span class="linenos">2</span><span class="go">ZAmWoJViiNn5pKz32m2MVgmPnSpgLia7z</span>
</pre></div>
</div>
<p>假设要发起一笔转账操作</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># 从账号发起</span>
<span class="linenos">2</span>./xchain-cli multisig gen --to czojZcZ6cHSiDVJ4jFoZMB1PjKnfUiuFQ --amount <span class="m">100</span> -A addr_list
<span class="linenos">3</span><span class="c1"># 从合约账号发起</span>
<span class="linenos">4</span>./xchain-cli multisig gen --to czojZcZ6cHSiDVJ4jFoZMB1PjKnfUiuFQ --amount <span class="m">100</span> -A addr_list --from XC11111111111111@xuper
</pre></div>
</div>
<p>这样会生成一个tx.out文件，包含了需发起的交易内容</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># 各方在签名之前可以check 原始交易是否ok，查看visual.out</span>
<span class="linenos">2</span>./xchain-cli multisig check --input tx.out --output visual.out
</pre></div>
</div>
<p>然后收集需要的签名</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># 首先需要发起者自己的签名</span>
<span class="linenos">2</span>./xchain-cli multisig sign --tx tx.out --output my.sign
<span class="linenos">3</span><span class="c1"># 假设addr_list中的地址对应的私钥存放在alice、bob中</span>
<span class="linenos">4</span>./xchain-cli multisig sign --keys data/account/alice --tx tx.out --output alice.sign
<span class="linenos">5</span>./xchain-cli multisig sign --keys data/account/bob --tx tx.out --output bob.sign
</pre></div>
</div>
<p>最后将交易和收集好的签名发出</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># send后第一个参数是发起者的签名文件，第二个参数是需要收集的签名文件，均为逗号分割</span>
<span class="linenos">2</span>./xchain-cli multisig send --tx tx.out my.sign alice.sign,bob.sign
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="design_documents/XuperModel.html" class="btn btn-neutral float-right" title="XuperModel" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="introduction/summary.html" class="btn btn-neutral float-left" title="总结" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
    </div>

  <hr/>

  <div role="contentinfo">
  <p>
    © 版权所有 2021, xuper.


  </p>
  </div>
    
    
    
    利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    
    由 <a href="https://readthedocs.org">Read the Docs</a>开发. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>